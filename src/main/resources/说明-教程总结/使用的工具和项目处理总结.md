# 项目开发流程工具

## H2数据库

### **用 H2 数据库的优势：**

> 1.无需连接真实数据库，可以模拟多种数据库产品
>
> 2.导出数据以更新测试集：H2 提供了一个专门的 SQL 命令叫做 SCRIPT，它可以将当前数据库的完整结构和数据导出为一个 .sql 文件

**减少资源消耗：** 无需启动和运行重量级的 MySQL 数据库及其 Docker 容器，从而释放了大量的 CPU 和内存资源。

**快速启动：** 作为内存数据库，H2 的启动速度非常快，能够加快开发周期中的应用程序启动和重启速度。

**简化配置：** Spring Boot 提供了对 H2 的自动配置支持，集成非常简单，通常只需要在 pom.xml 中添加依赖并进行少量配置即可。

**数据隔离：** 在开发或测试新功能时，你可以在 H2 数据库中随意操作，不必担心会污染团队共享的 MySQL 测试数据库中的数据。

**易于重置：** 内存模式下的 H2 数据库在每次应用程序重启后都会清空数据，确保每次启动都是一个干净的数据库环境，便于测试。并且提供文件模式暂时持久化

**环境隔离：**使用 Spring Profile 来区分开发和生产环境 spring.profiles.active=dev

**提供web端控制台：**数据表可视化

### H2数据库的使用和初始化

> 1**.schema.sql文件：**用标准sql语句定义表结构
>
> 2.**data.sql文件：**在运行前所需要的全部数据，使用标准insert填充

### 工作流程

> 配置H2 Maven
>
> 配置springboot3 H2工作模式，内存模式，是否自动销毁
>
> 使用schema.sql文件定义表结构，配合data.sql文件填充数据使用(可以实现前后端联调).
>
> （可选工作流程）:先创建真实MySQL数据库和数据表，使用mybatis-plus生成工具创建模板controller，service，mapper等等以及 PO，使用JPA注解标记PO(两种注解共存)，开启 JPA 的 DDL 自动生成功能可以根据扫描Po中@Entity注解自动生成ddl语句，避免编写schema.sql。缺点：引入**JPA/Hibernate** 增加复杂性和依赖**POJO/Entity 类变得混乱**，仅仅省略了schema.sql

## GraphQL

优秀实践

1. 模块化Schema.graphqls文件，按业拆分不同返回类型

2. ```
   Spring for GraphQL Starter: 官方提供的 GraphQL 集成
    (可选) GraphQL Java Extended Scalars: 提供了 JSON 等自定义标量类型的支持 
    配置：graphiql工具，在线使用交互请求
   ```

3. 可以用于快速实现，数据请求完全交给前端，省略vo的转换

4. 可以提供完全通用实体查询接口(仅用于快速测试)

5. 缺点:很可能出现N+1性能问题，需要额外处理

6. 缺点:鉴权过程需要为每个字段编写解析器（过程可能繁琐）自定义注解解决一部分

7. 缺点:由于使用Post请求无法缓存

   ​